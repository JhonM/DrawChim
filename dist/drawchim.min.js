!function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{var g;g="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,g.Drawchim=f()}}(function(){var define;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";function buildElement(buildOptions){var createElm,parentElm;createElm=document.createElement(buildOptions.elm),createElm.id=buildOptions.buttonId,createElm.innerHTML=buildOptions.buttonText,null!==(parentElm=document.getElementById(buildOptions.parentId))&&parentElm.appendChild(createElm)}var $$=require("domquery"),ExtendDefault=require("./src/extend_default"),StringAsNode=require("./src/string-as-node"),TemplateEngine=require("./src/template-engine"),ls=(require("./src/canvas-board"),require("./src/local-storage")),Touchy=require("touchy"),Modalblanc=require("modalblanc");Touchy.enableOn(document);var drawChim=function(options){if(!(this instanceof drawChim))return new drawChim;var defaults={stains:["255, 0, 0","0, 255, 0","0, 0, 255","0, 0, 0"],canvas:["canvas-1"]};arguments[0]&&"object"==typeof arguments[0]&&(this.options=ExtendDefault(defaults,arguments[0])),this.appId=null,this.canvasItems=[],this.canvasObject={},this.num=0,this.settingsActionSet=!1,this._init()};drawChim.prototype.buildCanvas=function(canvasName,stopBuild){var num=++this.num;this.num=num;var canvasID=canvasName?canvasName:"canvas-"+num;if(stopBuild)this.canvas=document.getElementById(canvasID),this.selectCanvas();else{if(buildElement({elm:"canvas",buttonId:canvasID,buttonText:null,parentId:this.appId}),this.canvas=document.getElementById(canvasID),this.canvasItems.push(this.canvas),this.canvasItems.length>1)for(var list=this.canvasItems,i=(this.canvas,0),len=list.length;i<len;i++)list[i].classList.remove("is-active"),ls.setItem("canvasItem-"+list[i].id,list[i].id,28425600);this.setCurrentCanvas(),this.selectCanvas()}this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.canvas.bgColor="#ffffff",this.isDown=!1,this.blankCanvas=!0,this.addColor=!1,this.ctx=this.canvas.getContext("2d"),this.canvasX,this.canvasY,this.createCanvas(),this.createStain(),this.storeCanvasAsImage(),this.setEvents()},drawChim.prototype.selectCanvas=function(){for(var list=this.canvasItems,currentCanvas=this.canvas,i=0,len=list.length;i<len;i++)list[i].style.zIndex="1",list[i].classList.remove("is-active");currentCanvas.style.zIndex="2",currentCanvas.classList.add("is-active")},drawChim.prototype.resizeCanvas=function(){this.canvas.setAttribute("width",window.innerWidth),this.canvas.setAttribute("height",window.innerHeight),this.storeCanvasAsImage(),this.createCanvas()},drawChim.prototype._init=function(){var newKey,newCanvas,DefaultCanvas=ls.getItem("canvasItem-"+this.options.canvas[0]);if(this.buildScene(),DefaultCanvas)for(var key in localStorage)key.match(/canvasItem-/)&&(newKey=key.replace("canvasItem-",""),this.buildCanvas(newKey));else for(var index in this.options.canvas)newCanvas=this.options.canvas[index],this.buildCanvas(newCanvas);this.resizeCanvas(),this.storeCanvasAsImage()},drawChim.prototype.createCanvas=function(){this.ctx.fillStyle=this.canvas.bgColor,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.lineWidth=6,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.strokeStyle="rgba("+this.options.stains[0]+", 0.5)"},drawChim.prototype.setCurrentCanvas=function(){this.canvasItems.slice(-1)[0].classList.add("is-active")},drawChim.prototype.buildScene=function(){var drawchimId,body=document.getElementsByTagName("body");body[0].id?drawchimId=body[0].id:(drawchimId="go-drawchim",body[0].id=drawchimId),buildElement({elm:"div",buttonId:"app-canvas",buttonText:null,parentId:drawchimId}),this.appId="app-canvas",buildElement({elm:"div",buttonId:"stain-pallet",buttonText:null,parentId:this.appId}),buildElement({elm:"span",buttonId:"overview-canvases",buttonText:"overview",parentId:this.appId})},drawChim.prototype.addStain=function(){var stains=TemplateEngine("<div><h1>Kies een kleur</h1><input type='color' value='#ff4499'/></div>",{colors:""});new Modalblanc({content:stains,animation:"slide-in-right"}).open()},drawChim.prototype.createStain=function(){var stainHolder=document.getElementById("stain-pallet");this.addColor&&(stainHolder.innerHTML="");var template='<ul class="stains"><%for(var index in this.colors) {%><li class="<%this.colors[index] === "'+this.options.stains[0]+'" ? "is-active" : null %>" data-color="<%this.colors[index]%>" style="background:rgb(<%this.colors[index]%>)"></li><%}%><li class="add-stain">+</li></ul>',stains=TemplateEngine(template,{colors:this.options.stains});stainHolder.innerHTML=stains},drawChim.prototype.setEvents=function(){var _this=this;this.canvas.addEventListener("touchstart",function(e){e.preventDefault(),_this.drawStart(e)},!1),this.canvas.addEventListener("touchmove",function(e){_this.drawMove(e)},!1),this.canvas.addEventListener("touchend",function(e){_this.drawEnd()},!1),$$("#clear").on("touchstart",function(){_this.clearCanvas()}),$$("#overview-canvases").on("touchstart",function(e){e.preventDefault(),_this.overview()}),$$(".stains li").on("touchstart",function(e){_this.swapColor(e)}),$$("#app-settings").on("touchstart",function(e){e.preventDefault(),_this.filters()}),$$(window).on("resize",function(){_this.resizeCanvas()}),$$("#pallets").on("swipe:down",function(){_this.closeOpenPallet(!0)}),$$("#header").on("swipe:up",function(){_this.closeOpenPallet(!1)}),$$(".add-stain").on("tap",function(){_this.addStain()}),$$(".canvas-overview-item").on("touchstart",function(e){var app=document.getElementById(_this.appId),canvasID=e.currentTarget.dataset.canvasId,overviewHolder=document.getElementsByClassName("canvas-overview-list");_this.buildCanvas(canvasID,!0),app.classList.remove("is-active"),app.removeChild(overviewHolder[0])})},drawChim.prototype.overview=function(){var app=document.getElementById(this.appId);if(!app.classList.length){app.classList.add("is-active");for(var getBase64=[],i=0,len=this.canvasItems.length;i<len;i++){var base64URL=ls.getItem("canvasImage-"+this.canvasItems[i].id);getBase64.push(base64URL)}var canvasOverview=TemplateEngine('<ul class="canvas-overview-list"><%for(var index in this.items) {%><li class="canvas-overview-item" data-canvas-id="<%this.items[index].id%>"><img src="<%this.imagesURL[index]%>" /></li><%}%></ul>',{items:this.canvasItems,imagesURL:getBase64});StringAsNode(app,canvasOverview),this.setEvents()}},drawChim.prototype.filters=function(){var settings=document.getElementById("app-settings");if("is-active"!==settings.classList.value){var filters=TemplateEngine("<div><h1>Kies filter</h1></div>",{colors:""});new Modalblanc({content:filters,closeButton:!1}).open(),settings.classList.add("is-active"),buildElement({elm:"a",buttonId:"close-modal",buttonText:"close modal",parentId:this.appId})}},drawChim.prototype.closeOpenPallet=function(state){state===!0?$$("#header").addClass("is-active"):$$("#header").removeClass("is-active")},drawChim.prototype.swapColor=function(event){var elm=event.srcElement,newColor=elm.dataset.color;$$(".stains li").removeClass("is-active"),$$(elm).addClass("is-active"),this.ctx.strokeStyle="rgba("+newColor+", 0.5)"},drawChim.prototype.colorPickerCircle=function(e){var touchObj=e.detail,stainCircle=document.getElementById("stain-circle");this.canvasX=touchObj.pageX-100,this.canvasY=touchObj.pageY-100,stainCircle.style.top=this.canvasY+"px",stainCircle.style.left=this.canvasX+"px",setTimeout(function(){$$(stainCircle).addClass("is-active")},300)},drawChim.prototype.drawStart=function(e){var touchObj=e.changedTouches[0];this.blankCanvas&&this.storeHistory(),this.isDown=!0,this.ctx.beginPath(),this.canvasX=touchObj.pageX-this.canvas.offsetLeft,this.canvasY=touchObj.pageY-this.canvas.offsetTop,this.ctx.moveTo(this.canvasX,this.canvasY)},drawChim.prototype.drawMove=function(e){var touchObj=e.changedTouches[0];this.isDown!==!1&&(this.canvasX=touchObj.pageX-this.canvas.offsetLeft,this.canvasY=touchObj.pageY-this.canvas.offsetTop,this.ctx.lineTo(this.canvasX,this.canvasY),this.ctx.stroke())},drawChim.prototype.drawEnd=function(){this.isDown=!1,this.ctx.closePath(),this.storeHistory()},drawChim.prototype.storeHistory=function(){var img=this.canvas.toDataURL("image/png");history.pushState({imageData:img},"",window.location.href),ls.setItem("canvasImage-"+this.canvas.id,img)},drawChim.prototype.storeCanvasAsImage=function(){var _this=this;if(window.localStorage){var img=new Image;img.onload=function(){_this.ctx.drawImage(img,0,0)};var imgSrc=ls.getItem("canvasImage-"+this.canvas.id);img.src=imgSrc,this.blankCanvas=!1}},drawChim.prototype.clearCanvas=function(){this.ctx.fillStyle=this.canvas.bgColor,this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.storeHistory()},module.exports=drawChim},{"./src/canvas-board":70,"./src/extend_default":71,"./src/local-storage":72,"./src/string-as-node":73,"./src/template-engine":74,domquery:34,modalblanc:50,touchy:64}],2:[function(require,module,exports){function check_kb(ev,opts){return ev.ctrlKey==(opts.ctrlKey||!1)&&ev.altKey==(opts.altKey||!1)&&ev.shiftKey==(opts.shiftKey||!1)&&ev.metaKey==(opts.metaKey||!1)&&ev.keyCode==(opts.keyCode||0)&&ev.charCode==(opts.charCode||0)||(ev=doc.createEvent("Event"),ev.initEvent(opts.type,opts.bubbles,opts.cancelable),ev.ctrlKey=opts.ctrlKey||!1,ev.altKey=opts.altKey||!1,ev.shiftKey=opts.shiftKey||!1,ev.metaKey=opts.metaKey||!1,ev.keyCode=opts.keyCode||0,ev.charCode=opts.charCode||0),ev}var doc=(require("global/window"),require("global/document")),use_key_event=(doc.documentElement,!0);try{doc.createEvent("KeyEvents")}catch(err){use_key_event=!1}var modern=function(type,opts){opts=opts||{};var family=typeOf(type),init_fam=family;"KeyboardEvent"===family&&use_key_event&&(family="KeyEvents",init_fam="KeyEvent");var ev=doc.createEvent(family),init_fn="init"+init_fam,init="function"==typeof ev[init_fn]?init_fn:"initEvent",sig=initSignatures[init],args=[],used={};opts.type=type;for(var i=0;i<sig.length;++i){var key=sig[i],val=opts[key];void 0===val&&(val=ev[key]),used[key]=!0,args.push(val)}ev[init].apply(ev,args),"KeyboardEvent"===family&&(ev=check_kb(ev,opts));for(var key in opts)used[key]||(ev[key]=opts[key]);return ev},legacy=function(type,opts){opts=opts||{};var ev=doc.createEventObject();ev.type=type;for(var key in opts)void 0!==opts[key]&&(ev[key]=opts[key]);return ev};module.exports=doc.createEvent?modern:legacy;var initSignatures=require("./init.json"),types=require("./types.json"),typeOf=function(){var typs={};for(var key in types)for(var ts=types[key],i=0;i<ts.length;i++)typs[ts[i]]=key;return function(name){return typs[name]||"Event"}}()},{"./init.json":3,"./types.json":4,"global/document":43,"global/window":44}],3:[function(require,module,exports){module.exports={initEvent:["type","bubbles","cancelable"],initUIEvent:["type","bubbles","cancelable","view","detail"],initMouseEvent:["type","bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget"],initMutationEvent:["type","bubbles","cancelable","relatedNode","prevValue","newValue","attrName","attrChange"],initKeyboardEvent:["type","bubbles","cancelable","view","ctrlKey","altKey","shiftKey","metaKey","keyCode","charCode"],initKeyEvent:["type","bubbles","cancelable","view","ctrlKey","altKey","shiftKey","metaKey","keyCode","charCode"]}},{}],4:[function(require,module,exports){module.exports={MouseEvent:["click","mousedown","mouseup","mouseover","mousemove","mouseout"],KeyboardEvent:["keydown","keyup","keypress"],MutationEvent:["DOMSubtreeModified","DOMNodeInserted","DOMNodeRemoved","DOMNodeRemovedFromDocument","DOMNodeInsertedIntoDocument","DOMAttrModified","DOMCharacterDataModified"],HTMLEvents:["load","unload","abort","error","select","change","submit","reset","focus","blur","resize","scroll"],UIEvent:["DOMFocusIn","DOMFocusOut","DOMActivate"]}},{}],5:[function(require,module,exports){(function(global){"use strict";function compare(a,b){if(a===b)return 0;for(var x=a.length,y=b.length,i=0,len=Math.min(x,y);i<len;++i)if(a[i]!==b[i]){x=a[i],y=b[i];break}return x<y?-1:y<x?1:0}function isBuffer(b){return global.Buffer&&"function"==typeof global.Buffer.isBuffer?global.Buffer.isBuffer(b):!(null==b||!b._isBuffer)}function pToString(obj){return Object.prototype.toString.call(obj)}function isView(arrbuf){return!isBuffer(arrbuf)&&("function"==typeof global.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(arrbuf):!!arrbuf&&(arrbuf instanceof DataView||!!(arrbuf.buffer&&arrbuf.buffer instanceof ArrayBuffer))))}function getName(func){if(util.isFunction(func)){if(functionsHaveNames)return func.name;var str=func.toString(),match=str.match(regex);return match&&match[1]}}function truncate(s,n){return"string"==typeof s?s.length<n?s:s.slice(0,n):s}function inspect(something){if(functionsHaveNames||!util.isFunction(something))return util.inspect(something);var rawname=getName(something);return"[Function"+(rawname?": "+rawname:"")+"]"}function getMessage(self){return truncate(inspect(self.actual),128)+" "+self.operator+" "+truncate(inspect(self.expected),128)}function fail(actual,expected,message,operator,stackStartFunction){throw new assert.AssertionError({message:message,actual:actual,expected:expected,operator:operator,stackStartFunction:stackStartFunction})}function ok(value,message){value||fail(value,!0,message,"==",assert.ok)}function _deepEqual(actual,expected,strict,memos){if(actual===expected)return!0;if(isBuffer(actual)&&isBuffer(expected))return 0===compare(actual,expected);if(util.isDate(actual)&&util.isDate(expected))return actual.getTime()===expected.getTime();if(util.isRegExp(actual)&&util.isRegExp(expected))return actual.source===expected.source&&actual.global===expected.global&&actual.multiline===expected.multiline&&actual.lastIndex===expected.lastIndex&&actual.ignoreCase===expected.ignoreCase;if(null!==actual&&"object"==typeof actual||null!==expected&&"object"==typeof expected){if(isView(actual)&&isView(expected)&&pToString(actual)===pToString(expected)&&!(actual instanceof Float32Array||actual instanceof Float64Array))return 0===compare(new Uint8Array(actual.buffer),new Uint8Array(expected.buffer));if(isBuffer(actual)!==isBuffer(expected))return!1;memos=memos||{actual:[],expected:[]};var actualIndex=memos.actual.indexOf(actual);return actualIndex!==-1&&actualIndex===memos.expected.indexOf(expected)||(memos.actual.push(actual),memos.expected.push(expected),objEquiv(actual,expected,strict,memos))}return strict?actual===expected:actual==expected}function isArguments(object){return"[object Arguments]"==Object.prototype.toString.call(object)}function objEquiv(a,b,strict,actualVisitedObjects){if(null===a||void 0===a||null===b||void 0===b)return!1;if(util.isPrimitive(a)||util.isPrimitive(b))return a===b;if(strict&&Object.getPrototypeOf(a)!==Object.getPrototypeOf(b))return!1;var aIsArgs=isArguments(a),bIsArgs=isArguments(b);if(aIsArgs&&!bIsArgs||!aIsArgs&&bIsArgs)return!1;if(aIsArgs)return a=pSlice.call(a),b=pSlice.call(b),_deepEqual(a,b,strict);var key,i,ka=objectKeys(a),kb=objectKeys(b);if(ka.length!==kb.length)return!1;for(ka.sort(),kb.sort(),i=ka.length-1;i>=0;i--)if(ka[i]!==kb[i])return!1;for(i=ka.length-1;i>=0;i--)if(key=ka[i],!_deepEqual(a[key],b[key],strict,actualVisitedObjects))return!1;return!0}function notDeepStrictEqual(actual,expected,message){_deepEqual(actual,expected,!0)&&fail(actual,expected,message,"notDeepStrictEqual",notDeepStrictEqual)}function expectedException(actual,expected){if(!actual||!expected)return!1;if("[object RegExp]"==Object.prototype.toString.call(expected))return expected.test(actual);try{if(actual instanceof expected)return!0}catch(e){}return!Error.isPrototypeOf(expected)&&expected.call({},actual)===!0}function _tryBlock(block){var error;try{block()}catch(e){error=e}return error}function _throws(shouldThrow,block,expected,message){var actual;if("function"!=typeof block)throw new TypeError('"block" argument must be a function');"string"==typeof expected&&(message=expected,expected=null),actual=_tryBlock(block),message=(expected&&expected.name?" ("+expected.name+").":".")+(message?" "+message:"."),shouldThrow&&!actual&&fail(actual,expected,"Missing expected exception"+message);var userProvidedMessage="string"==typeof message,isUnwantedException=!shouldThrow&&util.isError(actual),isUnexpectedException=!shouldThrow&&actual&&!expected;if((isUnwantedException&&userProvidedMessage&&expectedException(actual,expected)||isUnexpectedException)&&fail(actual,expected,"Got unwanted exception"+message),shouldThrow&&actual&&expected&&!expectedException(actual,expected)||!shouldThrow&&actual)throw actual}var util=require("util/"),hasOwn=Object.prototype.hasOwnProperty,pSlice=Array.prototype.slice,functionsHaveNames=function(){return"foo"===function(){}.name}(),assert=module.exports=ok,regex=/\s*function\s+([^\(\s]*)\s*/;assert.AssertionError=function(options){this.name="AssertionError",this.actual=options.actual,this.expected=options.expected,this.operator=options.operator,options.message?(this.message=options.message,this.generatedMessage=!1):(this.message=getMessage(this),this.generatedMessage=!0);var stackStartFunction=options.stackStartFunction||fail;if(Error.captureStackTrace)Error.captureStackTrace(this,stackStartFunction);else{var err=new Error;if(err.stack){var out=err.stack,fn_name=getName(stackStartFunction),idx=out.indexOf("\n"+fn_name);if(idx>=0){var next_line=out.indexOf("\n",idx+1);out=out.substring(next_line+1)}this.stack=out}}},util.inherits(assert.AssertionError,Error),assert.fail=fail,assert.ok=ok,assert.equal=function(actual,expected,message){actual!=expected&&fail(actual,expected,message,"==",assert.equal)},assert.notEqual=function(actual,expected,message){actual==expected&&fail(actual,expected,message,"!=",assert.notEqual)},assert.deepEqual=function(actual,expected,message){_deepEqual(actual,expected,!1)||fail(actual,expected,message,"deepEqual",assert.deepEqual)},assert.deepStrictEqual=function(actual,expected,message){_deepEqual(actual,expected,!0)||fail(actual,expected,message,"deepStrictEqual",assert.deepStrictEqual)},assert.notDeepEqual=function(actual,expected,message){_deepEqual(actual,expected,!1)&&fail(actual,expected,message,"notDeepEqual",assert.notDeepEqual)},assert.notDeepStrictEqual=notDeepStrictEqual,assert.strictEqual=function(actual,expected,message){actual!==expected&&fail(actual,expected,message,"===",assert.strictEqual)},assert.notStrictEqual=function(actual,expected,message){actual===expected&&fail(actual,expected,message,"!==",assert.notStrictEqual)},assert.throws=function(block,error,message){_throws(!0,block,error,message)},assert.doesNotThrow=function(block,error,message){_throws(!1,block,error,message)},assert.ifError=function(err){if(err)throw err};var objectKeys=Object.keys||function(obj){var keys=[];for(var key in obj)hasOwn.call(obj,key)&&keys.push(key);return keys}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"util/":69}],6:[function(require,module,exports){},{}],7:[function(require,module,exports){function closest(el,selector,scope){for(scope=scope||document.documentElement;el&&el!==scope;){if(matches(el,selector))return el;el=el.parentNode}return matches(el,selector)?el:null}try{var matches=require("matches-selector")}catch(err){var matches=require("component-matches-selector")}module.exports=closest},{"component-matches-selector":10,"matches-selector":10}],8:[function(require,module,exports){var closest=require("closest"),event=require("event");exports.bind=function(el,selector,type,fn,capture){return event.bind(el,type,function(e){var target=e.target||e.srcElement;e.delegateTarget=closest(target,selector,!0,el),e.delegateTarget&&fn.call(el,e)},capture)},exports.unbind=function(el,type,fn,capture){event.unbind(el,type,fn,capture)}},{closest:13,event:9}],9:[function(require,module,exports){function detect(){bind=window.addEventListener?"addEventListener":"attachEvent",unbind=window.removeEventListener?"removeEventListener":"detachEvent",prefix="addEventListener"!==bind?"on":""}var bind,unbind,prefix;exports.bind=function(el,type,fn,capture){return bind||detect(),el[bind](prefix+type,fn,capture||!1),fn},exports.unbind=function(el,type,fn,capture){return unbind||detect(),el[unbind](prefix+type,fn,capture||!1),fn}},{}],10:[function(require,module,exports){function match(el,selector){if(!el||1!==el.nodeType)return!1;if(vendor)return vendor.call(el,selector);for(var nodes=query.all(selector,el.parentNode),i=0;i<nodes.length;++i)if(nodes[i]==el)return!0;return!1}try{var query=require("query")}catch(err){var query=require("component-query")}var proto=Element.prototype,vendor=proto.matches||proto.webkitMatchesSelector||proto.mozMatchesSelector||proto.msMatchesSelector||proto.oMatchesSelector;module.exports=match},{"component-query":11,query:11}],11:[function(require,module,exports){function one(selector,el){return el.querySelector(selector)}exports=module.exports=function(selector,el){return el=el||document,one(selector,el)},exports.all=function(selector,el){return el=el||document,el.querySelectorAll(selector)},exports.engine=function(obj){if(!obj.one)throw new Error(".one callback required");if(!obj.all)throw new Error(".all callback required");return one=obj.one,exports.all=obj.all,exports}},{}],12:[function(require,module,exports){var now=function(){return Date.now()};module.exports=function(f,ms,ctx,immediate){var ts,fn,args,timeout=null;return fn=function(){ctx=ctx||this,args=arguments,ts=now();var later=function(){var diff=now()-ts;if(diff<ms)return void(timeout=setTimeout(later,ms-diff));timeout=null,immediate||f.apply(ctx,args)};null===timeout&&(immediate&&f.apply(ctx,args),timeout=setTimeout(later,ms))},fn.cancel=function(){clearTimeout(timeout)},fn}},{}],13:[function(require,module,exports){var matches=require("matches-selector");module.exports=function(element,selector,checkYoSelf,root){for(element=checkYoSelf?{parentNode:element}:element,root=root||document;(element=element.parentNode)&&element!==document;){if(matches(element,selector))return element;if(element===root)return}}},{"matches-selector":10}],14:[function(require,module,exports){"use strict";var DOMEvent=require("@bendrucker/synthetic-dom-events"),assert=require("assert");module.exports=function(element,event,options){return assert(element,"A DOM element is required"),"string"==typeof event&&(event=DOMEvent(event,options)),element.dispatchEvent(event),event}},{"@bendrucker/synthetic-dom-events":2,assert:5}],15:[function(require,module,exports){function classes(el){if(el.classList)return el.classList;var str=el.className.replace(/^\s+|\s+$/g,""),arr=str.split(whitespaceRe);return""===arr[0]&&arr.shift(),arr}function add(el,name){if(el.classList)return void el.classList.add(name);var arr=classes(el);~index(arr,name)||arr.push(name),el.className=arr.join(" ")}function has(el,name){return el.classList?el.classList.contains(name):!!~index(classes(el),name)}function remove(el,name){if("[object RegExp]"==toString.call(name))return removeMatching(el,name);if(el.classList)return void el.classList.remove(name);var arr=classes(el),i=index(arr,name);~i&&arr.splice(i,1),el.className=arr.join(" ")}function removeMatching(el,re,ref){for(var arr=Array.prototype.slice.call(classes(el)),i=0;i<arr.length;i++)re.test(arr[i])&&remove(el,arr[i])}function toggle(el,name){if(el.classList)return el.classList.toggle(name);has(el,name)?remove(el,name):add(el,name)}var index=require("indexof"),whitespaceRe=/\s+/,toString=Object.prototype.toString;module.exports=classes,module.exports.add=add,module.exports.contains=has,module.exports.has=has,module.exports.toggle=toggle,module.exports.remove=remove,module.exports.removeMatching=removeMatching},{indexof:45}],16:[function(require,module,exports){var evtLifeCycle={},extend=require("extend"),cache=require("./lib/event-cache"),getEventCache=cache.getCache.bind(cache),dispatchEvent=require("./lib/dispatch-event"),domEvent=require("./lib/dom-event"),wrapCallback=require("./lib/wrap-callback");module.exports={register:function(evt,lifecycle){evtLifeCycle[evt]=lifecycle},trigger:function(ele,event){if(!event)throw new Error("event is required");var eventCache=getEventCache(ele);(eventCache=eventCache[event])&&Object.keys(eventCache).forEach(function(fnId){var fn=eventCache[fnId];fn&&fn.apply(ele,[{type:event}])})},fire:function(ele,evt,opts){dispatchEvent(ele,evt,opts)},on:function(ele,event,selector,callback,capture){var me=this;if(!ele)throw new Error("missing argument element");if(!event)throw new Error("missing argument event");event.split(/\s+/).forEach(function(type){var parts=type.split("."),eventName=parts.shift(),descriptor={event:eventName,selector:selector,callback:callback,capture:capture,ns:parts.reduce(function(seq,ns){return seq[ns]=!0,seq},{})};me._on(ele,descriptor)})},_on:function(ele,descriptor){descriptor=descriptor||{};var event=descriptor.event,selector=descriptor.selector,capture=descriptor.capture,ns=descriptor.ns;"function"==typeof selector&&(descriptor.callback=selector,selector="");var callbackId=require("./lib/get-callback-id")(descriptor.callback),eventLifeCycleEvent=evtLifeCycle[event],eventCache=getEventCache(ele,event);eventLifeCycleEvent&&(0===Object.keys(eventCache).length&&eventLifeCycleEvent.setup&&eventLifeCycleEvent.setup.apply(ele,[descriptor]),eventLifeCycleEvent.add&&eventLifeCycleEvent.add.apply(ele,[descriptor]));var callback=descriptor.callback;callback.xFId=callbackId;var wrappedFn=wrapCallback(ele,callback,ns,selector);return eventCache[wrappedFn.xFId]=wrappedFn,domEvent.on(ele,event,wrappedFn,capture)},off:function(ele,event,callback,capture){var me=this;event.split(/\s+/).forEach(function(type){var parts=type.split("."),eventName=parts.shift(),descriptor={event:eventName,callback:callback,capture:capture,ns:parts.reduce(function(seq,ns){return seq[ns]=!0,seq},{})};me._off(ele,descriptor)})},_doRemoveEvent:function(ele,event,callback,capture){var eventCache=getEventCache(ele),currentEventCache=eventCache[event];if(currentEventCache){var xFId=callback.xFId;if(xFId){delete currentEventCache[xFId];var eventLifeCycleEvent=evtLifeCycle[event];eventLifeCycleEvent&&eventLifeCycleEvent.remove&&eventLifeCycleEvent.remove.apply(ele,{event:event,callback:callback,capture:capture}),0===Object.keys(eventCache).length&&(delete eventCache[event],eventLifeCycleEvent&&eventLifeCycleEvent.teardown&&eventLifeCycleEvent.teardown.apply(ele,{event:event,callback:callback,capture:capture}))}domEvent.off(ele,event,callback,capture)}},_off:function(ele,descriptor){var me=this,eventCache=getEventCache(ele),events=Object.keys(eventCache);if(0!==events.length&&(descriptor.event||events.forEach(function(event){me._off(ele,extend({},descriptor,{event:event}))}),(eventCache=eventCache[descriptor.event])&&0!==Object.keys(eventCache).length)){var callback=descriptor.callback;if(callback){var id=callback.xFId;return void(id&&Object.keys(eventCache).forEach(function(key){var fn=eventCache[key];fn.callbackId===id&&me._doRemoveEvent(ele,descriptor.event,fn,descriptor.capture)}))}var namespaces=Object.keys(descriptor.ns),hasNamespaces=namespaces.length>0;Object.keys(eventCache).forEach(function(fnId){var fn=eventCache[fnId];hasNamespaces?namespaces.forEach(function(namespace){fn.xNS[namespace]&&me._doRemoveEvent(ele,descriptor.event,fn,descriptor.capture)}):me._doRemoveEvent(ele,descriptor.event,fn,descriptor.capture)})}}}},{"./lib/dispatch-event":17,"./lib/dom-event":18,"./lib/event-cache":19,"./lib/get-callback-id":20,"./lib/wrap-callback":22,extend:41}],17:[function(require,module,exports){(function(global){module.exports=function(ele,event,options){var extend=require("extend"),opts=extend({bubbles:!0},options),setEvent=!1,CustomEvent=global.CustomEvent;if(CustomEvent){var evt;try{evt=new CustomEvent(event,opts),ele.dispatchEvent(evt),setEvent=!0}catch(ex){setEvent=!1}}if(!setEvent){require("dispatch-event")(ele,event,opts)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"dispatch-event":14,extend:41}],18:[function(require,module,exports){function on(element,event,callback,capture){return!element.addEventListener&&(event="on"+event),(element.addEventListener||element.attachEvent).call(element,event,callback,capture),callback}function off(element,event,callback,capture){return!element.removeEventListener&&(event="on"+event),(element.removeEventListener||element.detachEvent).call(element,event,callback,capture),callback}module.exports=on,module.exports.on=on,module.exports.off=off},{}],19:[function(require,module,exports){function getCache(ele,event,_cache){var eleId;return ele===document&&(eleId="document"),ele===window&&(eleId="window"),eleId||(eleId=ele.getAttribute("x-des-id"))||(eleId=getId(),ele.setAttribute("x-des-id",eleId)),_cache[eleId]=_cache[eleId]||{},event?(_cache[eleId][event]=_cache[eleId][event]||{},_cache[eleId][event]):_cache[eleId]}var cache={},idGen=require("./id-gen"),getId=idGen.create("dom-ele");module.exports={getCache:function(ele,event){return getCache(ele,event,cache)}}},{"./id-gen":21}],20:[function(require,module,exports){var idGen=require("./id-gen"),getFnId=idGen.create("fn");module.exports=function(callback){var eleId=callback.xFId;return eleId||(eleId=getFnId(),callback.xFId=eleId),eleId}},{"./id-gen":21}],21:[function(require,module,exports){module.exports={create:function(prefix){var counter=0;return function(){return prefix+"-"+Date.now()+"-"+counter++}}}},{}],22:[function(require,module,exports){var closest=require("component-closest"),getIdOfCallback=require("./get-callback-id");module.exports=function(ele,callback,ns,selector){var fn=function(e){var args=arguments;if(!selector)return callback.apply(ele,args);var closestEle=closest(e.target||e.srcElement,selector,ele);return closestEle?callback.apply(closestEle,args):void 0};return getIdOfCallback(fn),fn.xNS=ns,fn.callbackId=getIdOfCallback(callback),fn}},{"./get-callback-id":20,"component-closest":7}],23:[function(require,module,exports){function on(element,event,callback,capture){return!element.addEventListener&&(event="on"+event),(element.addEventListener||element.attachEvent).call(element,event,callback,capture),callback}function off(element,event,callback,capture){return!element.removeEventListener&&(event="on"+event),(element.removeEventListener||element.detachEvent).call(element,event,callback,capture),callback}module.exports=on,module.exports.on=on,module.exports.off=off},{}],24:[function(require,module,exports){function one(selector,parent){return parent||(parent=document),parent.querySelector(selector)}function all(selector,parent){parent||(parent=document);var selection=parent.querySelectorAll(selector);return Array.prototype.slice.call(selection)}module.exports=one,module.exports.all=all},{}],25:[function(require,module,exports){function all(element,css){var name;for(name in css)one(element,name,css[name])}function one(element,name,value){element.style[toCamelCase("float"==name?"cssFloat":name)]=value}function style(element){return 3==arguments.length?one(element,arguments[1],arguments[2]):all(element,arguments[1])}var toCamelCase=require("to-camel-case");module.exports=style},{"to-camel-case":61}],
26:[function(require,module,exports){function add(parent,child,vars){select(parent).appendChild(newElement(child,vars))}function addAfter(parent,child){var ref=select(arguments[arguments.length-1],parent).nextSibling,vars=arguments.length>3?arguments[2]:void 0;if(null==ref)return add(parent,child,vars);addBefore(parent,child,vars,ref)}function addBefore(parent,child){var ref=arguments[arguments.length-1],vars=arguments.length>3?arguments[2]:void 0;select(parent).insertBefore(newElement(child,vars),select(ref,parent))}function insert(element){var parent=arguments[arguments.length-1],vars=arguments.length>2?arguments[1]:void 0;add(select(parent),element,vars)}function replace(parent,target,repl,vars){select(parent).replaceChild(select(newElement(repl,vars)),select(target,parent))}function remove(element,child){var i,all;if(1==arguments.length&&"string"!=typeof element)return element.parentNode.removeChild(element);for(all=arguments.length>1?select.all(child,element):select.all(element),i=all.length;i--;)all[i].parentNode.removeChild(all[i])}function withChildren(fn){return function(_,children){Array.isArray(children)||(children=[children]);for(var i=-1,len=children.length,params=Array.prototype.slice.call(arguments);++i<len;)params[1]=children[i],fn.apply(void 0,params)}}var newElement=require("./new-element"),select=require("./select");module.exports={add:withChildren(add),addAfter:withChildren(addAfter),addBefore:withChildren(addBefore),insert:insert,replace:replace,remove:remove}},{"./new-element":27,"./select":31}],27:[function(require,module,exports){function ifNecessary(html,vars){return isHTML(html)?newElement(html,vars):html}function isHTML(text){return"string"==typeof text&&"<"==text.charAt(0)}var newElement=require("new-element");module.exports=ifNecessary},{"new-element":30}],28:[function(require,module,exports){function all(selector,parent){return qwery(selector,parent)}function one(selector,parent){return all(selector,parent)[0]}var qwery=require("qwery");module.exports={one:one,all:all}},{qwery:59}],29:[function(require,module,exports){function one(selector,parent){return parent||(parent=document),parent.querySelector?parent.querySelector(selector):fallback.one(selector,parent)}function all(selector,parent){return parent||(parent=document),parent.querySelectorAll?parent.querySelectorAll(selector):fallback.all(selector,parent)}var fallback=require("./fallback");module.exports=one,module.exports.all=all},{"./fallback":28}],30:[function(require,module,exports){function newElement(html,vars){return domify(1==arguments.length?html:format(html,vars))}var domify=require("domify"),format=require("format-text");module.exports=newElement},{domify:33,"format-text":42}],31:[function(require,module,exports){function ifNecessary(child,parent){return Array.isArray(child)&&(child=child[0]),"string"!=typeof child?child:("string"==typeof parent&&(parent=select(parent,document)),select(child,parent))}function ifNecessaryAll(child,parent){return Array.isArray(child)&&(child=child[0]),"string"!=typeof child?[child]:("string"==typeof parent&&(parent=select(parent,document)),select.all(child,parent))}var select=require("dom-select");module.exports=ifNecessary,module.exports.all=ifNecessaryAll},{"dom-select":29}],32:[function(require,module,exports){function get(el){switch(type(el)){case"checkbox":case"radio":if(el.checked){var attr=el.getAttribute("value");return null==attr||attr}return!1;case"radiogroup":for(var radio,i=0;radio=el[i];i++)if(radio.checked)return radio.value;break;case"select":for(var option,i=0;option=el.options[i];i++)if(option.selected)return option.value;break;default:return el.value}}function set(el,val){switch(type(el)){case"checkbox":case"radio":el.checked=!!val;break;case"radiogroup":for(var radio,i=0;radio=el[i];i++)radio.checked=radio.value===val;break;case"select":for(var option,i=0;option=el.options[i];i++)option.selected=option.value===val;break;default:el.value=val}}function type(el){var group="array"==typeOf(el)||"object"==typeOf(el);group&&(el=el[0]);var name=el.nodeName.toLowerCase(),type=el.getAttribute("type");return group&&type&&"radio"==type.toLowerCase()?"radiogroup":"input"==name&&type&&"checkbox"==type.toLowerCase()?"checkbox":"input"==name&&type&&"radio"==type.toLowerCase()?"radio":"select"==name?"select":name}function typeOf(val){switch(Object.prototype.toString.call(val)){case"[object Date]":return"date";case"[object RegExp]":return"regexp";case"[object Arguments]":return"arguments";case"[object Array]":return"array";case"[object Error]":return"error"}return null===val?"null":void 0===val?"undefined":val!==val?"nan":val&&1===val.nodeType?"element":typeof(val=val.valueOf?val.valueOf():Object.prototype.valueOf.apply(val))}module.exports=function(el,val){return 2==arguments.length?set(el,val):get(el)}},{}],33:[function(require,module,exports){function parse(html){if("string"!=typeof html)throw new TypeError("String expected");var m=/<([\w:]+)/.exec(html);if(!m)throw new Error("No elements were generated.");var tag=m[1];if("body"==tag){var el=document.createElement("html");return el.innerHTML=html,el.removeChild(el.lastChild)}var wrap=map[tag]||map._default,depth=wrap[0],prefix=wrap[1],suffix=wrap[2],el=document.createElement("div");for(el.innerHTML=prefix+html+suffix;depth--;)el=el.lastChild;var els=el.children;if(1==els.length)return el.removeChild(els[0]);for(var fragment=document.createDocumentFragment();els.length;)fragment.appendChild(el.removeChild(els[0]));return fragment}module.exports=parse;var map={option:[1,'<select multiple="multiple">',"</select>"],optgroup:[1,'<select multiple="multiple">',"</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tbody:[1,"<table>","</table>"],tfoot:[1,"<table>","</table>"],colgroup:[1,"<table>","</table>"],caption:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],th:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],_default:[0,"",""]}},{}],34:[function(require,module,exports){function create(tag){return select("<"==tag.charAt(0)?newElement(tag):document.createElement(tag))}var newElement=require("new-element"),select=require("./lib/select");module.exports=select,module.exports.create=create},{"./lib/select":38,"new-element":56}],35:[function(require,module,exports){function attr(chain){return function(element,name,value){return 2==arguments.length?element.getAttribute(name):(element.setAttribute(name,value),chain)}}module.exports=attr},{}],36:[function(require,module,exports){function shortcut(type){return function(element,callback){return on(element,type,callback)}}function off(element,event,selector,callback){if(4==arguments.length)return delegate.unbind(element,selector,event,callback);callback=selector,events.off(element,event,callback)}function on(element,event,selector,callback){if(3==arguments.length&&(callback=selector),4==arguments.length)return delegate.bind(element,selector,event,callback);events.on(element,event,callback)}function onKey(element,key,callback){keyEvent.on(element,key,callback)}function offKey(element,key,callback){keyEvent.off(element,key,callback)}var events=require("dom-event"),delegate=require("component-delegate"),keyEvent=require("key-event");require("trim");module.exports={change:shortcut("change"),click:shortcut("click"),keydown:shortcut("keydown"),keyup:shortcut("keyup"),keypress:shortcut("keypress"),mousedown:shortcut("mousedown"),mouseover:shortcut("mouseover"),mouseup:shortcut("mouseup"),resize:shortcut("resize"),on:on,off:off,onKey:onKey,offKey:offKey}},{"component-delegate":8,"dom-event":23,"key-event":46,trim:66}],37:[function(require,module,exports){function html(chain){return function(element,newValue,vars){return arguments.length>1?(element.innerHTML=arguments.length>2?format(newValue,vars):newValue,chain):element.innerHTML}}var format=require("format-text");module.exports=html},{"format-text":42}],38:[function(require,module,exports){function show(e){style(e,"display","")}function hide(e){style(e,"display","none")}function select(query){var key,chain,methods,elements;elements="string"==typeof query&&"<"==query.charAt(0)?[newElement(query,arguments[1])]:"string"==typeof query?Array.prototype.slice.call(selectDOM(query,arguments[1])):query==document?[document.documentElement]:1==arguments.length&&Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments),methods={addClass:applyEachElement(classes.add,elements),removeClass:applyEachElement(classes.remove,elements),toggleClass:applyEachElement(classes.toggle,elements),show:applyEachElement(show,elements),hide:applyEachElement(hide,elements),style:applyEachElement(style,elements)};for(key in events)methods[key]=applyEachElement(events[key],elements);for(key in tree)methods[key]=applyEachElement(tree[key],elements);return chain=newChain.from(elements)(methods),chain.attr=applyEachElement(attr(chain),elements),chain.classes=applyEachElement(classes,elements),chain.hasClass=applyEachElement(classes.has,elements),chain.html=applyEachElement(html(chain),elements),chain.text=applyEachElement(text(chain),elements),chain.val=applyEachElement(value(chain),elements),chain.value=applyEachElement(value(chain),elements),chain.parent=selectEachElement(parent,elements),chain.select=selectEachElement(selectChild,elements),chain.siblings=selectEachElement(siblings,elements),chain}function parent(element,selector){return selector?closest(element,selector):element.parentNode}function selectChild(element,query){return select(query,element)}function applyEachElement(fn,elements){if(!fn)throw new Error("Undefined function.");return function(){var i,len,ret,params,ret;for(len=elements.length,i=-1,params=[void 0].concat(Array.prototype.slice.call(arguments));++i<len;)params[0]=elements[i],ret=fn.apply(void 0,params);return ret}}function selectEachElement(fn,els){return function(){for(var ret,t,tlen,result=[],params=[void 0].concat(Array.prototype.slice.call(arguments)),len=els.length,i=-1;++i<len;)if(params[0]=els[i],ret=fn.apply(void 0,params),Array.isArray(ret))for(tlen=ret.length,t=-1;++t<tlen;)result.indexOf(ret[t])==-1&&result.push(ret[t]);else ret&&result.indexOf(ret)==-1&&result.push(ret);return select(result)}}var newChain=require("new-chain"),classes=(require("format-text"),require("dom-classes")),tree=require("dom-tree"),newElement=require("new-element"),selectDOM=require("dom-select").all,style=require("dom-style"),closest=require("discore-closest"),siblings=require("siblings"),attr=require("./attr"),events=require("./events"),html=require("./html"),text=require("./text"),value=require("./value");module.exports=select},{"./attr":35,"./events":36,"./html":37,"./text":39,"./value":40,"discore-closest":13,"dom-classes":15,"dom-select":24,"dom-style":25,"dom-tree":26,"format-text":42,"new-chain":55,"new-element":56,siblings:60}],39:[function(require,module,exports){function text(chain){return function(element,newValue,vars){return arguments.length>1?(element.textContent=arguments.length>2?format(newValue,vars):newValue,chain):element.textContent}}var format=require("format-text");module.exports=text},{"format-text":42}],40:[function(require,module,exports){function withChain(chain){return function(el,update){return 2==arguments.length?(value(el,update),chain):value(el)}}var value=require("dom-value");module.exports=withChain},{"dom-value":32}],41:[function(require,module,exports){"use strict";var hasOwn=Object.prototype.hasOwnProperty,toStr=Object.prototype.toString,isArray=function(arr){return"function"==typeof Array.isArray?Array.isArray(arr):"[object Array]"===toStr.call(arr)},isPlainObject=function(obj){if(!obj||"[object Object]"!==toStr.call(obj))return!1;var hasOwnConstructor=hasOwn.call(obj,"constructor"),hasIsPrototypeOf=obj.constructor&&obj.constructor.prototype&&hasOwn.call(obj.constructor.prototype,"isPrototypeOf");if(obj.constructor&&!hasOwnConstructor&&!hasIsPrototypeOf)return!1;var key;for(key in obj);return void 0===key||hasOwn.call(obj,key)};module.exports=function extend(){var options,name,src,copy,copyIsArray,clone,target=arguments[0],i=1,length=arguments.length,deep=!1;for("boolean"==typeof target?(deep=target,target=arguments[1]||{},i=2):("object"!=typeof target&&"function"!=typeof target||null==target)&&(target={});i<length;++i)if(null!=(options=arguments[i]))for(name in options)src=target[name],copy=options[name],target!==copy&&(deep&&copy&&(isPlainObject(copy)||(copyIsArray=isArray(copy)))?(copyIsArray?(copyIsArray=!1,clone=src&&isArray(src)?src:[]):clone=src&&isPlainObject(src)?src:{},target[name]=extend(deep,clone,copy)):void 0!==copy&&(target[name]=copy));return target}},{}],42:[function(require,module,exports){function format(text){var context;return context="object"==typeof arguments[1]&&arguments[1]?arguments[1]:Array.prototype.slice.call(arguments,1),String(text).replace(/\{?\{([^{}]+)}}?/g,replace(context))}function replace(context,nil){return function(tag,name){return"{{"==tag.substring(0,2)&&"}}"==tag.substring(tag.length-2)?"{"+name+"}":context.hasOwnProperty(name)?"function"==typeof context[name]?context[name]():context[name]:tag}}module.exports=format},{}],43:[function(require,module,exports){(function(global){var topLevel=void 0!==global?global:"undefined"!=typeof window?window:{},minDoc=require("min-document");if("undefined"!=typeof document)module.exports=document;else{var doccy=topLevel["__GLOBAL_DOCUMENT_CACHE@4"];doccy||(doccy=topLevel["__GLOBAL_DOCUMENT_CACHE@4"]=minDoc),module.exports=doccy}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"min-document":6}],44:[function(require,module,exports){(function(global){"undefined"!=typeof window?module.exports=window:void 0!==global?module.exports=global:"undefined"!=typeof self?module.exports=self:module.exports={}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],45:[function(require,module,exports){var indexOf=[].indexOf;module.exports=function(arr,obj){if(indexOf)return arr.indexOf(obj);for(var i=0;i<arr.length;++i)if(arr[i]===obj)return i;return-1}},{}],46:[function(require,module,exports){function on(element,keys,callback){var expected=parse(keys),fn=events.on(element,"keyup",function(event){(event.ctrlKey||void 0)==expected.ctrl&&(event.altKey||void 0)==expected.alt&&(event.shiftKey||void 0)==expected.shift&&keynameOf(event.keyCode)==expected.key&&callback(event)});return callback["cb-"+keys]=fn,callback}function off(element,keys,callback){events.off(element,"keyup",callback["cb-"+keys])}function parse(keys){var result={};keys=keys.split(/[^\w]+/);for(var name,i=keys.length;i--;)name=keys[i].trim(),"ctrl"!=name?"alt"!=name?"shift"!=name?result.key=name.trim():result.shift=!0:result.alt=!0:result.ctrl=!0;return result}var keynameOf=require("keyname-of"),events=require("dom-event");module.exports=on,module.exports.on=on,module.exports.off=off},{"dom-event":23,"keyname-of":47}],47:[function(require,module,exports){function keynameOf(n){return map[n]||String.fromCharCode(n).toLowerCase()}var map=require("keynames");module.exports=keynameOf},{keynames:48}],48:[function(require,module,exports){module.exports={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"}},{}],49:[function(require,module,exports){"use strict";function match(el,selector){if(vendor)return vendor.call(el,selector);for(var nodes=el.parentNode.querySelectorAll(selector),i=0;i<nodes.length;i++)if(nodes[i]==el)return!0;return!1}var proto=Element.prototype,vendor=proto.matches||proto.matchesSelector||proto.webkitMatchesSelector||proto.mozMatchesSelector||proto.msMatchesSelector||proto.oMatchesSelector;module.exports=match},{}],50:[function(require,module,exports){"use strict";function typeOfAnimation(type,typeClass){var animationTypes={slide:["slide-next","slide-back"],scale:["scale-next","scale-back"]},animationClass=animationTypes[type];return void 0===type?2===typeClass?animationTypes.slide[1]:animationTypes.slide[0]:2===typeClass?animationClass[1]:animationClass[0]}function transitionPrefix(elm){var transEndEventNames={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var name in transEndEventNames)if(void 0!==elm.style[name])return{end:transEndEventNames[name]}}function setEvents(){var nextButton=document.getElementById("modal-button-next"),prevButton=document.getElementById("modal-button-prev"),closed=document.getElementsByClassName("modal-fullscreen-close"),_this=this;this.classEventListener(closed,function(){_this.close()}),keyboardActions.call(this),null!==this.options.sideTwo.content&&(nextButton.addEventListener("click",this._contentNext.bind(this)),prevButton.addEventListener("click",this._contentPrevious.bind(this)))}function build(){this.modalContainer=document.getElementsByClassName("modal-fullscreen-container"),this.options.closeButton&&(this.closeButton='<span class="modal-fullscreen-close">X</span>');var modalId,contentSideOne=contentType(this.options.slider?'<div id="modal-slider"></div>':this.options.content),typeModal=this.options.slider?"slider-modal":"big-modal",modalTemplate=Template('<div id="overlay-modal-blanc" class="modal-fullscreen-background <%this.animation%> <%this.state%>"><div id="modal-fullscreen-container"class="modal-fullscreen-container <%this.type%> "><div id="card"><div class="front"><div id="front-card" class="modal-fullscreen-item"><%this.closeButton%><%this.contentTypeSideOne%></div></div><div class="back"><div  id="back-card" class="modal-fullscreen-item"><%this.closeButton%><%this.contentTypeSideTwo%></div></div></div></div></div>',{animation:this.options.animation,state:"is-active",type:typeModal,closeButton:this.closeButton,contentTypeSideOne:contentSideOne,contentTypeSideTwo:contentType(this.options.sideTwo.content)}),body=document.getElementsByTagName("body");body[0].id?modalId=body[0].id:(modalId="go-modal",body[0].id=modalId),StringAsNode(document.getElementById(modalId),modalTemplate),this.settings.modalOpen=!0,this.options.slider&&this.sliderInit("#modal-slider"),null!==this.options.sideTwo.content&&(buildButton(this.options.sideTwo.button),buildButton(this.options.sideTwo.buttonBack))}function buildElement(buildOptions){var createElm,parentElm;createElm=document.createElement(buildOptions.elm),createElm.id=buildOptions.buttonId,createElm.innerHTML=buildOptions.buttonText,parentElm=document.getElementById(buildOptions.parentId),parentElm.appendChild(createElm)}function buildButton(elm){if(null===elm||void 0===elm){if(document.getElementById("modal-button-next")||document.getElementById("modal-button-prev"))return;buildElement({elm:"a",buttonId:"modal-button-next",buttonText:"Next step",parentId:"front-card"}),buildElement({elm:"a",buttonId:"modal-button-prev",buttonText:"Previous step",parentId:"back-card"})}else buildElement({elm:elm.element,buttonId:elm.id,buttonText:elm.text,parentId:elm.parent})}function contentType(contentValue){return"string"==typeof contentValue?contentValue:null===contentValue?"":contentValue.innerHTML}function addClass(selector,className){selector[0].classList.add(className)}function removeClass(selector,className){selector[0].classList.remove(className)}function keyboardActions(){var _this=this;document.onkeyup=function(e){e.preventDefault(),_this.settings.modalOpen&&27==e.keyCode&&_this.close()}}var ExtendDefault=require("./lib/extend_default"),ImageSlider=require("./lib/image_slider"),StringAsNode=require("./lib/string_as_node"),Template=require("./lib/template-engine"),Modalblanc=function(){if(!(this instanceof Modalblanc))return new Modalblanc;this.closeButton=null,this.overlay=null;var defaults={animation:"fade-in-out",closeButton:!0,content:"",slider:null,sideTwo:{content:null,animation:null,button:null,buttonBack:null}};this.settings={},this.hasSlider=!!this.hasSlider,this.sliderIsOpen=!1,arguments[0]&&"object"==typeof arguments[0]&&(this.options=ExtendDefault(defaults,arguments[0]))};Modalblanc.prototype.open=function(){this.settings.modalOpen||(build.call(this),setEvents.call(this))},Modalblanc.prototype.close=function(){if(this.settings.modalOpen){var overlay=document.getElementById("overlay-modal-blanc"),_this=this;overlay.classList.remove("is-active"),overlay.classList.add("is-inactive");var transPrefix=transitionPrefix(overlay);overlay.addEventListener(transPrefix.end,function(){this.remove(),_this.settings.modalOpen=!1},!1),document.onkeyup=null,document.onkeydown=null}},Modalblanc.prototype.sliderInit=function(side){null!==this.options.slider&&(this.hasSlider=!0),this.hasSlider&&(this.open(),this.sliderIsOpen=!0,this.slider=new ImageSlider({parent:side,selector:this.options.slider}))},Modalblanc.prototype._contentNext=function(){this.hasSlider&&(this.sliderIsOpen=!1,this.slider.playing&&this.slider.pause(),removeClass(this.modalContainer,"slider-modal"),addClass(this.modalContainer,"big-modal"));var card=document.getElementById("card"),customClass=this.options.sideTwo.animation;card.classList.remove(typeOfAnimation(customClass,2)),card.classList.add(typeOfAnimation(customClass))},Modalblanc.prototype._contentPrevious=function(){this.hasSlider&&(removeClass(this.modalContainer,"big-modal"),addClass(this.modalContainer,"slider-modal"));var card=document.getElementById("card"),customClass=this.options.sideTwo.animation;card.classList.remove(typeOfAnimation(customClass)),card.classList.add(typeOfAnimation(customClass,2))},Modalblanc.prototype.classEventListener=function(elm,callback){for(var i=0;i<elm.length;i++)elm[i].addEventListener("click",function(){callback()})},module.exports=Modalblanc},{"./lib/extend_default":51,"./lib/image_slider":52,"./lib/string_as_node":53,"./lib/template-engine":54}],51:[function(require,module,exports){"use strict";module.exports=function(source,properties){var property;for(property in properties)properties.hasOwnProperty(property)&&(source[property]=properties[property]);return source}},{}],52:[function(require,module,exports){"use strict";function setEvents(){var playButton=document.getElementById("play-btn"),previousButton=document.getElementById("previous-btn"),nextButton=document.getElementById("next-btn"),_this=this;playButton.onclick=function(){_this.playing?_this.pause():_this.play()},previousButton.onclick=function(){_this.pause(),_this.previousSlide()},nextButton.onclick=function(){_this.pause(),_this.nextSlide()},keyboardActions.call(this)}function keyboardActions(){var _this=this;document.onkeydown=function(e){e.preventDefault(),37==e.keyCode?_this.previousSlide():39==e.keyCode&&_this.nextSlide()}}var ExtendDefault=require("./extend_default"),ImageSlider=function(){if(!(this instanceof ImageSlider))return new ImageSlider;var defaults={selector:".slides",transition:"fade-slide",autoPlay:!1};arguments[0]&&"object"==typeof arguments[0]&&(this.options=ExtendDefault(defaults,arguments[0]));this.currentSlide=0,this.playing,this._init(),this.slider=document.querySelectorAll(".image-slider-holder .image-slider"),this.setSlide(),this.options.autoPlay&&this.play()};ImageSlider.prototype._init=function(){this.createSlides(),setEvents.call(this)},ImageSlider.prototype.createSlides=function(){this.slides=[];var slides,images=this.options.selector;slides=images instanceof Array?images:document.querySelectorAll(this.options.selector+" img");var slideImg,sliderElm,imgElm,parentEl=document.querySelector(this.options.parent),container=document.createElement("div"),slider=document.createElement("ul");container.className="image-slider-container",slider.className="image-slider-holder";for(var i=0;i<slides.length;i++)slideImg=slides[i].src?slides[i].src:slides[i],this.slides.push({index:i,el:slides[i],images:slideImg}),sliderElm=document.createElement("li"),sliderElm.className="image-slider",imgElm=document.createElement("img"),imgElm.src=slideImg,sliderElm.appendChild(imgElm),slider.appendChild(sliderElm),container.appendChild(slider),parentEl.appendChild(container);this.playBtn=document.createElement("span"),this.playBtn.id="play-btn",slider.appendChild(this.playBtn),this.previousBtn=document.createElement("span"),this.previousBtn.id="previous-btn",slider.appendChild(this.previousBtn),this.nextBtn=document.createElement("span"),this.nextBtn.id="next-btn",slider.appendChild(this.nextBtn)},ImageSlider.prototype.setSlide=function(){this.slider[0].classList.add("is-showing")},ImageSlider.prototype.nextSlide=function(){this.goToSlide(this.currentSlide+1,"next")},ImageSlider.prototype.previousSlide=function(){this.goToSlide(this.currentSlide-1,"previous")},ImageSlider.prototype.goToSlide=function(n,side){var slides=this.slider;slides[this.currentSlide].className=side+" image-slider",this.currentSlide=(n+slides.length)%slides.length,slides[this.currentSlide].className=side+" image-slider is-showing",this.prevSlide="previous"===side?(this.currentSlide+1)%slides.length:(this.currentSlide-1)%slides.length,"previous"===side?this.currentSlide===slides.length?slides[slides.length+1].className=side+" image-slider is-hiding":slides[this.prevSlide].className=side+" image-slider is-hiding":0===this.currentSlide?slides[slides.length-1].className=side+" image-slider is-hiding":slides[this.prevSlide].className=side+" image-slider is-hiding"},ImageSlider.prototype.pause=function(){this.playBtn.classList.remove("is-pause"),this.playing=!1,clearInterval(this.slideInterval)},ImageSlider.prototype.play=function(){var _this=this;this.playBtn.classList.add("is-pause"),this.playing=!0,this.slideInterval=setInterval(function(){_this.nextSlide()},2e3)},module.exports=ImageSlider},{"./extend_default":51}],53:[function(require,module,exports){"use strict";module.exports=function(element,html){if(null!==html){var child,frag=document.createDocumentFragment(),tmp=document.createElement("body");for(tmp.innerHTML=html;child=tmp.firstChild;)frag.appendChild(child);element.appendChild(frag),frag=tmp=null}}},{}],54:[function(require,module,exports){"use strict";module.exports=function(html,options){for(var match,result,re=/<%(.+?)%>/g,code="with(obj) { var r=[];\n",cursor=0,add=function(line,js){return code+=js?line.match(/(^( )?(var|if|for|else|switch|case|break|{|}|;))(.*)?/g)?line+"\n":"r.push("+line+");\n":""!=line?'r.push("'+line.replace(/"/g,'\\"')+'");\n':"",add};match=re.exec(html);)add(html.slice(cursor,match.index))(match[1],!0),cursor=match.index+match[0].length;add(html.substr(cursor,html.length-cursor)),code=(code+'return r.join(""); }').replace(/[\r\t\n]/g,"");try{result=new Function("obj",code).apply(options,[options])}catch(err){console.error("'"+err.message+"'"," in \n\nCode:\n",code,"\n")}return result}},{}],55:[function(require,module,exports){function from(chain){return function(){var m,i;for(m=methods.apply(void 0,arguments),i=m.length;i--;)chain[m[i].name]=m[i].fn;return m.forEach(function(method){chain[method.name]=function(){return method.fn.apply(this,arguments),chain}}),chain}}function methods(){var all,el,i,result,key;for(all=Array.prototype.slice.call(arguments),result=[],i=all.length;i--;)if("function"!=typeof(el=all[i])){if("object"==typeof el)for(key in el)result.push({name:key,fn:el[key]})}else result.push({name:el.name,fn:el});return result}function newChain(){return from({}).apply(void 0,arguments)}module.exports=newChain,module.exports.from=from},{}],56:[function(require,module,exports){arguments[4][30][0].apply(exports,arguments)},{domify:33,dup:30,"format-text":57}],57:[function(require,module,exports){function format(text){var context;return context="object"==typeof arguments[1]&&arguments[1]?arguments[1]:Array.prototype.slice.call(arguments,1),String(text).replace(/\{?\{([^\{\}]+)\}\}?/g,replace(context))}function replace(context,nil){return function(tag,name){return"{{"==tag.substring(0,2)&&"}}"==tag.substring(tag.length-2)?"{"+name+"}":context.hasOwnProperty(name)?"function"==typeof context[name]?context[name]():context[name]:tag}}module.exports=format},{}],58:[function(require,module,exports){function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(fun){if(cachedSetTimeout===setTimeout)return setTimeout(fun,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(fun,0);try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout)return clearTimeout(marker);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(marker);try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var timeout=runTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,runClearTimeout(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}var cachedSetTimeout,cachedClearTimeout,process=module.exports={};!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var currentQueue,queue=[],draining=!1,queueIndex=-1;process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}},{}],59:[function(require,module,exports){!function(name,context,definition){void 0!==module&&module.exports?module.exports=definition():"function"==typeof define&&define.amd?define(definition):context.qwery=definition()}(0,this,function(){function cache(){this.c={}}function classRegex(c){return classCache.g(c)||classCache.s(c,"(^|\\s+)"+c+"(\\s+|$)",1)}function each(a,fn){for(var i=0,l=a.length;i<l;i++)fn(a[i])}function flatten(ar){for(var r=[],i=0,l=ar.length;i<l;++i)arrayLike(ar[i])?r=r.concat(ar[i]):r[r.length]=ar[i];return r}function arrayify(ar){for(var i=0,l=ar.length,r=[];i<l;i++)r[i]=ar[i];return r}function previous(n){for(;(n=n.previousSibling)&&1!=n[nodeType];);return n}function q(query){return query.match(chunker)}function interpret(whole,tag,idsAndClasses,wholeAttribute,attribute,qualifier,value,wholePseudo,pseudo,wholePseudoVal,pseudoVal){var i,m,k,o,classes;if(1!==this[nodeType])return!1;if(tag&&"*"!==tag&&this[tagName]&&this[tagName].toLowerCase()!==tag)return!1
;if(idsAndClasses&&(m=idsAndClasses.match(id))&&m[1]!==this.id)return!1;if(idsAndClasses&&(classes=idsAndClasses.match(clas)))for(i=classes.length;i--;)if(!classRegex(classes[i].slice(1)).test(this.className))return!1;if(pseudo&&qwery.pseudos[pseudo]&&!qwery.pseudos[pseudo](this,pseudoVal))return!1;if(wholeAttribute&&!value){o=this.attributes;for(k in o)if(Object.prototype.hasOwnProperty.call(o,k)&&(o[k].name||k)==attribute)return this}return!(wholeAttribute&&!checkAttr(qualifier,getAttr(this,attribute)||"",value))&&this}function clean(s){return cleanCache.g(s)||cleanCache.s(s,s.replace(specialChars,"\\$1"))}function checkAttr(qualify,actual,val){switch(qualify){case"=":return actual==val;case"^=":return actual.match(attrCache.g("^="+val)||attrCache.s("^="+val,"^"+clean(val),1));case"$=":return actual.match(attrCache.g("$="+val)||attrCache.s("$="+val,clean(val)+"$",1));case"*=":return actual.match(attrCache.g(val)||attrCache.s(val,clean(val),1));case"~=":return actual.match(attrCache.g("~="+val)||attrCache.s("~="+val,"(?:^|\\s+)"+clean(val)+"(?:\\s+|$)",1));case"|=":return actual.match(attrCache.g("|="+val)||attrCache.s("|="+val,"^"+clean(val)+"(-|$)",1))}return 0}function _qwery(selector,_root){var i,l,m,token,els,intr,item,r=[],ret=[],root=_root,tokens=tokenCache.g(selector)||tokenCache.s(selector,selector.split(tokenizr)),dividedTokens=selector.match(dividers);if(!tokens.length)return r;if(token=(tokens=tokens.slice(0)).pop(),tokens.length&&(m=tokens[tokens.length-1].match(idOnly))&&(root=byId(_root,m[1])),!root)return r;for(intr=q(token),els=root!==_root&&9!==root[nodeType]&&dividedTokens&&/^[+~]$/.test(dividedTokens[dividedTokens.length-1])?function(r){for(;root=root.nextSibling;)1==root[nodeType]&&(intr[1]?intr[1]==root[tagName].toLowerCase():1)&&(r[r.length]=root);return r}([]):root[byTag](intr[1]||"*"),i=0,l=els.length;i<l;i++)(item=interpret.apply(els[i],intr))&&(r[r.length]=item);return tokens.length?(each(r,function(e){ancestorMatch(e,tokens,dividedTokens)&&(ret[ret.length]=e)}),ret):r}function is(el,selector,root){if(isNode(selector))return el==selector;if(arrayLike(selector))return!!~flatten(selector).indexOf(el);for(var tokens,dividedTokens,selectors=selector.split(",");selector=selectors.pop();)if(tokens=tokenCache.g(selector)||tokenCache.s(selector,selector.split(tokenizr)),dividedTokens=selector.match(dividers),tokens=tokens.slice(0),interpret.apply(el,q(tokens.pop()))&&(!tokens.length||ancestorMatch(el,tokens,dividedTokens,root)))return!0;return!1}function ancestorMatch(el,tokens,dividedTokens,root){function crawl(e,i,p){for(;p=walker[dividedTokens[i]](p,e);)if(isNode(p)&&interpret.apply(p,q(tokens[i]))){if(!i)return p;if(cand=crawl(p,i-1,p))return cand}}var cand;return(cand=crawl(el,tokens.length-1,el))&&(!root||isAncestor(cand,root))}function isNode(el,t){return el&&"object"==typeof el&&(t=el[nodeType])&&(1==t||9==t)}function uniq(ar){var i,j,a=[];o:for(i=0;i<ar.length;++i){for(j=0;j<a.length;++j)if(a[j]==ar[i])continue o;a[a.length]=ar[i]}return a}function arrayLike(o){return"object"==typeof o&&isFinite(o.length)}function normalizeRoot(root){return root?"string"==typeof root?qwery(root)[0]:!root[nodeType]&&arrayLike(root)?root[0]:root:doc}function byId(root,id,el){return 9===root[nodeType]?root.getElementById(id):root.ownerDocument&&((el=root.ownerDocument.getElementById(id))&&isAncestor(el,root)&&el||!isAncestor(root,root.ownerDocument)&&select('[id="'+id+'"]',root)[0])}function qwery(selector,_root){var m,el,root=normalizeRoot(_root);if(!root||!selector)return[];if(selector===window||isNode(selector))return!_root||selector!==window&&isNode(root)&&isAncestor(selector,root)?[selector]:[];if(selector&&arrayLike(selector))return flatten(selector);if(m=selector.match(easy)){if(m[1])return(el=byId(root,m[1]))?[el]:[];if(m[2])return arrayify(root[byTag](m[2]));if(hasByClass&&m[3])return arrayify(root[byClass](m[3]))}return select(selector,root)}function collectSelector(root,collector){return function(s){var oid,nid;if(splittable.test(s))return void(9!==root[nodeType]&&((nid=oid=root.getAttribute("id"))||root.setAttribute("id",nid="__qwerymeupscotty"),s='[id="'+nid+'"]'+s,collector(root.parentNode||root,s,!0),oid||root.removeAttribute("id")));s.length&&collector(root,s,!1)}}var select,doc=document,html=doc.documentElement,byClass="getElementsByClassName",byTag="getElementsByTagName",qSA="querySelectorAll",tagName="tagName",nodeType="nodeType",id=/#([\w\-]+)/,clas=/\.[\w\-]+/g,idOnly=/^#([\w\-]+)$/,splittable=/(^|,)\s*[>~+]/,splittersMore=/(?![\s\w\-\/\?\&\=\:\.\(\)\!,@#%<>\{\}\$\*\^'"]*\]|[\s\w\+\-]*\))/,specialChars=/([.*+?\^=!:${}()|\[\]\/\\])/g,easy=new RegExp(idOnly.source+"|"+/^([\w\-]+)$/.source+"|"+/^\.([\w\-]+)$/.source),dividers=new RegExp("("+/[\s\>\+\~]/.source+")"+splittersMore.source,"g"),tokenizr=new RegExp(/[\s\>\+\~]/.source+splittersMore.source),chunker=new RegExp(/^(\*|[a-z0-9]+)?(?:([\.\#]+[\w\-\.#]+)?)/.source+"("+/\[([\w\-]+)(?:([\|\^\$\*\~]?\=)['"]?([ \w\-\/\?\&\=\:\.\(\)\!,@#%<>\{\}\$\*\^]+)["']?)?\]/.source+")?("+/:([\w\-]+)(\(['"]?([^()]+)['"]?\))?/.source+")?"),walker={" ":function(node){return node&&node!==html&&node.parentNode},">":function(node,contestant){return node&&node.parentNode==contestant.parentNode&&node.parentNode},"~":function(node){return node&&node.previousSibling},"+":function(node,contestant,p1,p2){return!!node&&((p1=previous(node))&&(p2=previous(contestant))&&p1==p2&&p1)}};cache.prototype={g:function(k){return this.c[k]||void 0},s:function(k,v,r){return v=r?new RegExp(v):v,this.c[k]=v}};var classCache=new cache,cleanCache=new cache,attrCache=new cache,tokenCache=new cache,isAncestor="compareDocumentPosition"in html?function(element,container){return 16==(16&container.compareDocumentPosition(element))}:"contains"in html?function(element,container){return(container=9===container[nodeType]||container==window?html:container)!==element&&container.contains(element)}:function(element,container){for(;element=element.parentNode;)if(element===container)return 1;return 0},getAttr=function(){var e=doc.createElement("p");return(e.innerHTML='<a href="#x">x</a>')&&"#x"!=e.firstChild.getAttribute("href")?function(e,a){return"class"===a?e.className:"href"===a||"src"===a?e.getAttribute(a,2):e.getAttribute(a)}:function(e,a){return e.getAttribute(a)}}(),hasByClass=!!doc[byClass],hasQSA=doc.querySelector&&doc[qSA],selectQSA=function(selector,root){var ss,e,result=[];try{return 9!==root[nodeType]&&splittable.test(selector)?(each(ss=selector.split(","),collectSelector(root,function(ctx,s){e=ctx[qSA](s),1==e.length?result[result.length]=e.item(0):e.length&&(result=result.concat(arrayify(e)))})),ss.length>1&&result.length>1?uniq(result):result):arrayify(root[qSA](selector))}catch(ex){}return selectNonNative(selector,root)},selectNonNative=function(selector,root){var items,m,i,l,r,ss,result=[];if(selector=selector.replace(/^\s+|\s*([,\s\+\~>]|$)\s*/g,"$1"),m=selector.match(/^([\w]+)?\.([\w\-]+)$/)){for(r=classRegex(m[2]),items=root[byTag](m[1]||"*"),i=0,l=items.length;i<l;i++)r.test(items[i].className)&&(result[result.length]=items[i]);return result}return each(ss=selector.split(","),collectSelector(root,function(ctx,s,rewrite){for(r=_qwery(s,ctx),i=0,l=r.length;i<l;i++)(9===ctx[nodeType]||rewrite||isAncestor(r[i],root))&&(result[result.length]=r[i])})),ss.length>1&&result.length>1?uniq(result):result},configure=function(options){void 0!==options.useNativeQSA&&(select=options.useNativeQSA&&hasQSA?selectQSA:selectNonNative)};return configure({useNativeQSA:!0}),qwery.configure=configure,qwery.uniq=uniq,qwery.is=is,qwery.pseudos={},qwery})},{}],60:[function(require,module,exports){var matches=require("matches-selector");module.exports=function(el,selector){for(var node=el.parentNode.firstChild,siblings=[];node;node=node.nextSibling)1===node.nodeType&&node!==el&&(selector?matches(node,selector)&&siblings.push(node):siblings.push(node));return siblings}},{"matches-selector":49}],61:[function(require,module,exports){function toCamelCase(string){return space(string).replace(/\s(\w)/g,function(matches,letter){return letter.toUpperCase()})}var space=require("to-space-case");module.exports=toCamelCase},{"to-space-case":63}],62:[function(require,module,exports){function toNoCase(string){return hasSpace.test(string)?string.toLowerCase():hasSeparator.test(string)?(unseparate(string)||string).toLowerCase():hasCamel.test(string)?uncamelize(string).toLowerCase():string.toLowerCase()}function unseparate(string){return string.replace(separatorSplitter,function(m,next){return next?" "+next:""})}function uncamelize(string){return string.replace(camelSplitter,function(m,previous,uppers){return previous+" "+uppers.toLowerCase().split("").join(" ")})}module.exports=toNoCase;var hasSpace=/\s/,hasSeparator=/(_|-|\.|:)/,hasCamel=/([a-z][A-Z]|[A-Z][a-z])/,separatorSplitter=/[\W_]+(.|$)/g,camelSplitter=/(.)([A-Z]+)/g},{}],63:[function(require,module,exports){function toSpaceCase(string){return clean(string).replace(/[\W_]+(.|$)/g,function(matches,match){return match?" "+match:""}).trim()}var clean=require("to-no-case");module.exports=toSpaceCase},{"to-no-case":62}],64:[function(require,module,exports){module.exports={enableOn:function(el,opts){return new(require("./touchy"))(el,opts)}}},{"./touchy":65}],65:[function(require,module,exports){function Touchy(el,opts){var me=this;me._opts={minSwipeDeltaX:25,minSwipeDeltaY:25,tap:!0,taphold:!0,swipe:!0,minTapDisplacementTolerance:10,tapHoldMinThreshold:500,swipeThreshold:1e3,mousedownThreshold:500,discardTapholdIfMove:!0},extend(me._opts,opts);var ele=me.el="object"==typeof el&&null!==el?el:document.getElementById(el);me.moved=!1,me.startX=0,me.startY=0,me._mouseEventsAllowed=!0,me.setMouseEventsAllowed=debounce(function(){me._mouseEventsAllowed=!0},me._opts.mousedownThreshold),ele.addEventListener("touchstart",me,!1),ele.addEventListener("mousedown",me,!1)}var debounce=require("debouncy"),extend=require("extend"),eventHelper=require("dom-event-special"),tapProto=Touchy.prototype;tapProto.blockMouseEvents=function(){var me=this;me._mouseEventsAllowed=!1,me.setMouseEventsAllowed()},tapProto._getClientX=function(e){return e.touches&&e.touches.length>0?e.touches[0].clientX:e.clientX},tapProto._getClientY=function(e){return e.touches&&e.touches.length>0?e.touches[0].clientY:e.clientY},tapProto._getPageX=function(e){return e.touches&&e.touches.length>0?e.touches[0].pageX:e.pageX},tapProto._getPageY=function(e){return e.touches&&e.touches.length>0?e.touches[0].pageY:e.pageY},tapProto.start=function(e){var me=this,ele=me.el;me.startTime=Date.now(),"touchstart"===e.type&&(ele.addEventListener("touchmove",me,!1),ele.addEventListener("touchend",me,!1),ele.addEventListener("touchcancel",me,!1),me.checkForTaphold(e),me.blockMouseEvents()),"mousedown"!==e.type||!me._mouseEventsAllowed||1!==e.which&&0!==e.button||(ele.addEventListener("mousemove",me,!1),ele.addEventListener("mouseup",me,!1),me.checkForTaphold(e)),me.startTarget=e.target,me.handlingStart=!0,me.moved=!1,me.startX=me._getClientX(e),me.startY=me._getClientY(e)},tapProto.checkForTaphold=function(e){var me=this;me._opts.taphold&&(clearTimeout(me.tapHoldInterval),me.tapHoldInterval=setTimeout(function(){me.moved&&me._opts.discardTapholdIfMove||!me.handlingStart||!me._opts.taphold||eventHelper.fire(me.startTarget,"tap:hold",{bubbles:!0,cancelable:!0,detail:{pageX:me._getPageX(e),pageY:me._getPageY(e)}})},me._opts.tapHoldMinThreshold))},tapProto.move=function(e){var me=this;me._moveX=me._getClientX(e),me._moveY=me._getClientY(e);var tolerance=me._opts.minTapDisplacementTolerance;(Math.abs(me._moveX-this.startX)>tolerance||Math.abs(me._moveY-this.startY)>tolerance)&&(this.moved=!0)},tapProto.end=function(e){var me=this,ele=me.el;ele.removeEventListener("mousemove",me,!1),ele.removeEventListener("touchmove",me,!1),ele.removeEventListener("touchend",me,!1),ele.removeEventListener("touchcancel",me,!1),ele.removeEventListener("mouseup",me,!1);var target=e.target,endTime=Date.now(),timeDelta=endTime-me.startTime;if(me.handlingStart=!1,clearTimeout(me.tapHoldInterval),!me.moved)return target!==me.startTarget||timeDelta>me._opts.tapHoldMinThreshold?void(me.startTarget=null):void(me._opts.tap&&eventHelper.fire(target,"tap",{bubbles:!0,cancelable:!0,detail:{pageX:me._getPageX(e),pageY:me._getPageY(e)}}));if(me._opts.swipe&&!(timeDelta>me._opts.swipeThreshold)){var deltaX=me._moveX-me.startX,deltaY=me._moveY-me.startY,absDeltaX=Math.abs(deltaX),absDeltaY=Math.abs(deltaY),swipeInX=absDeltaX>me._opts.minSwipeDeltaX,swipeInY=absDeltaY>me._opts.minSwipeDeltaY;if(swipeInX||swipeInY){var direction="";direction+=absDeltaX>=absDeltaY?deltaX>0?"right":"left":deltaY>0?"down":"up",eventHelper.fire(target,"swipe",{bubbles:!0,cancelable:!0,detail:{direction:direction,deltaX:deltaX,deltaY:deltaY}}),eventHelper.fire(target,"swipe:"+direction,{bubbles:!0,cancelable:!0,detail:{direction:direction,deltaX:deltaX,deltaY:deltaY}})}}},tapProto.cancel=function(){var me=this;clearTimeout(me.tapHoldInterval),me.handlingStart=!1,me.moved=!1,me.startX=0,me.startY=0},tapProto.destroy=function(){var me=this,ele=me.el;me.handlingStart=!1,clearTimeout(me.tapHoldInterval),ele.removeEventListener("touchstart",me,!1),ele.removeEventListener("touchmove",me,!1),ele.removeEventListener("touchend",me,!1),ele.removeEventListener("touchcancel",me,!1),ele.removeEventListener("mousedown",me,!1),ele.removeEventListener("mouseup",me,!1),me.el=null},tapProto.handleEvent=function(e){var me=this;switch(e.type){case"touchstart":me.start(e);break;case"mousemove":me.move(e);break;case"touchmove":me.move(e);break;case"touchend":me.end(e);break;case"touchcancel":me.cancel(e);break;case"mousedown":me.start(e);break;case"mouseup":me.end(e)}},module.exports=Touchy},{debouncy:12,"dom-event-special":16,extend:41}],66:[function(require,module,exports){function trim(str){return str.replace(/^\s*|\s*$/g,"")}exports=module.exports=trim,exports.left=function(str){return str.replace(/^\s*/,"")},exports.right=function(str){return str.replace(/\s*$/,"")}},{}],67:[function(require,module,exports){"function"==typeof Object.create?module.exports=function(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})}:module.exports=function(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype,ctor.prototype=new TempCtor,ctor.prototype.constructor=ctor}},{}],68:[function(require,module,exports){module.exports=function(arg){return arg&&"object"==typeof arg&&"function"==typeof arg.copy&&"function"==typeof arg.fill&&"function"==typeof arg.readUInt8}},{}],69:[function(require,module,exports){(function(process,global){function inspect(obj,opts){var ctx={seen:[],stylize:stylizeNoColor};return arguments.length>=3&&(ctx.depth=arguments[2]),arguments.length>=4&&(ctx.colors=arguments[3]),isBoolean(opts)?ctx.showHidden=opts:opts&&exports._extend(ctx,opts),isUndefined(ctx.showHidden)&&(ctx.showHidden=!1),isUndefined(ctx.depth)&&(ctx.depth=2),isUndefined(ctx.colors)&&(ctx.colors=!1),isUndefined(ctx.customInspect)&&(ctx.customInspect=!0),ctx.colors&&(ctx.stylize=stylizeWithColor),formatValue(ctx,obj,ctx.depth)}function stylizeWithColor(str,styleType){var style=inspect.styles[styleType];return style?"["+inspect.colors[style][0]+"m"+str+"["+inspect.colors[style][1]+"m":str}function stylizeNoColor(str,styleType){return str}function arrayToHash(array){var hash={};return array.forEach(function(val,idx){hash[val]=!0}),hash}function formatValue(ctx,value,recurseTimes){if(ctx.customInspect&&value&&isFunction(value.inspect)&&value.inspect!==exports.inspect&&(!value.constructor||value.constructor.prototype!==value)){var ret=value.inspect(recurseTimes,ctx);return isString(ret)||(ret=formatValue(ctx,ret,recurseTimes)),ret}var primitive=formatPrimitive(ctx,value);if(primitive)return primitive;var keys=Object.keys(value),visibleKeys=arrayToHash(keys);if(ctx.showHidden&&(keys=Object.getOwnPropertyNames(value)),isError(value)&&(keys.indexOf("message")>=0||keys.indexOf("description")>=0))return formatError(value);if(0===keys.length){if(isFunction(value)){var name=value.name?": "+value.name:"";return ctx.stylize("[Function"+name+"]","special")}if(isRegExp(value))return ctx.stylize(RegExp.prototype.toString.call(value),"regexp");if(isDate(value))return ctx.stylize(Date.prototype.toString.call(value),"date");if(isError(value))return formatError(value)}var base="",array=!1,braces=["{","}"];if(isArray(value)&&(array=!0,braces=["[","]"]),isFunction(value)){base=" [Function"+(value.name?": "+value.name:"")+"]"}if(isRegExp(value)&&(base=" "+RegExp.prototype.toString.call(value)),isDate(value)&&(base=" "+Date.prototype.toUTCString.call(value)),isError(value)&&(base=" "+formatError(value)),0===keys.length&&(!array||0==value.length))return braces[0]+base+braces[1];if(recurseTimes<0)return isRegExp(value)?ctx.stylize(RegExp.prototype.toString.call(value),"regexp"):ctx.stylize("[Object]","special");ctx.seen.push(value);var output;return output=array?formatArray(ctx,value,recurseTimes,visibleKeys,keys):keys.map(function(key){return formatProperty(ctx,value,recurseTimes,visibleKeys,key,array)}),ctx.seen.pop(),reduceToSingleString(output,base,braces)}function formatPrimitive(ctx,value){if(isUndefined(value))return ctx.stylize("undefined","undefined");if(isString(value)){var simple="'"+JSON.stringify(value).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return ctx.stylize(simple,"string")}return isNumber(value)?ctx.stylize(""+value,"number"):isBoolean(value)?ctx.stylize(""+value,"boolean"):isNull(value)?ctx.stylize("null","null"):void 0}function formatError(value){return"["+Error.prototype.toString.call(value)+"]"}function formatArray(ctx,value,recurseTimes,visibleKeys,keys){for(var output=[],i=0,l=value.length;i<l;++i)hasOwnProperty(value,String(i))?output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,String(i),!0)):output.push("");return keys.forEach(function(key){key.match(/^\d+$/)||output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,key,!0))}),output}function formatProperty(ctx,value,recurseTimes,visibleKeys,key,array){var name,str,desc;if(desc=Object.getOwnPropertyDescriptor(value,key)||{value:value[key]},desc.get?str=desc.set?ctx.stylize("[Getter/Setter]","special"):ctx.stylize("[Getter]","special"):desc.set&&(str=ctx.stylize("[Setter]","special")),hasOwnProperty(visibleKeys,key)||(name="["+key+"]"),str||(ctx.seen.indexOf(desc.value)<0?(str=isNull(recurseTimes)?formatValue(ctx,desc.value,null):formatValue(ctx,desc.value,recurseTimes-1),str.indexOf("\n")>-1&&(str=array?str.split("\n").map(function(line){return"  "+line}).join("\n").substr(2):"\n"+str.split("\n").map(function(line){return"   "+line}).join("\n"))):str=ctx.stylize("[Circular]","special")),isUndefined(name)){if(array&&key.match(/^\d+$/))return str;name=JSON.stringify(""+key),name.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(name=name.substr(1,name.length-2),name=ctx.stylize(name,"name")):(name=name.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),name=ctx.stylize(name,"string"))}return name+": "+str}function reduceToSingleString(output,base,braces){var numLinesEst=0;return output.reduce(function(prev,cur){return numLinesEst++,cur.indexOf("\n")>=0&&numLinesEst++,prev+cur.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?braces[0]+(""===base?"":base+"\n ")+" "+output.join(",\n  ")+" "+braces[1]:braces[0]+base+" "+output.join(", ")+" "+braces[1]}function isArray(ar){return Array.isArray(ar)}function isBoolean(arg){return"boolean"==typeof arg}function isNull(arg){return null===arg}function isNullOrUndefined(arg){return null==arg}function isNumber(arg){return"number"==typeof arg}function isString(arg){return"string"==typeof arg}function isSymbol(arg){return"symbol"==typeof arg}function isUndefined(arg){return void 0===arg}function isRegExp(re){return isObject(re)&&"[object RegExp]"===objectToString(re)}function isObject(arg){return"object"==typeof arg&&null!==arg}function isDate(d){return isObject(d)&&"[object Date]"===objectToString(d)}function isError(e){return isObject(e)&&("[object Error]"===objectToString(e)||e instanceof Error)}function isFunction(arg){return"function"==typeof arg}function isPrimitive(arg){return null===arg||"boolean"==typeof arg||"number"==typeof arg||"string"==typeof arg||"symbol"==typeof arg||void 0===arg}function objectToString(o){return Object.prototype.toString.call(o)}function pad(n){return n<10?"0"+n.toString(10):n.toString(10)}function timestamp(){var d=new Date,time=[pad(d.getHours()),pad(d.getMinutes()),pad(d.getSeconds())].join(":");return[d.getDate(),months[d.getMonth()],time].join(" ")}function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}exports.format=function(f){if(!isString(f)){for(var objects=[],i=0;i<arguments.length;i++)objects.push(inspect(arguments[i]));return objects.join(" ")}for(var i=1,args=arguments,len=args.length,str=String(f).replace(/%[sdj%]/g,function(x){if("%%"===x)return"%";if(i>=len)return x;switch(x){case"%s":return String(args[i++]);case"%d":return Number(args[i++]);case"%j":try{return JSON.stringify(args[i++])}catch(_){return"[Circular]"}default:return x}}),x=args[i];i<len;x=args[++i])isNull(x)||!isObject(x)?str+=" "+x:str+=" "+inspect(x);return str},exports.deprecate=function(fn,msg){function deprecated(){if(!warned){if(process.throwDeprecation)throw new Error(msg);process.traceDeprecation?console.trace(msg):console.error(msg),warned=!0}return fn.apply(this,arguments)}if(isUndefined(global.process))return function(){return exports.deprecate(fn,msg).apply(this,arguments)};if(process.noDeprecation===!0)return fn;var warned=!1;return deprecated};var debugEnviron,debugs={};exports.debuglog=function(set){if(isUndefined(debugEnviron)&&(debugEnviron=process.env.NODE_DEBUG||""),set=set.toUpperCase(),!debugs[set])if(new RegExp("\\b"+set+"\\b","i").test(debugEnviron)){var pid=process.pid;debugs[set]=function(){var msg=exports.format.apply(exports,arguments);console.error("%s %d: %s",set,pid,msg)}}else debugs[set]=function(){};return debugs[set]},exports.inspect=inspect,inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},inspect.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},exports.isArray=isArray,exports.isBoolean=isBoolean,exports.isNull=isNull,exports.isNullOrUndefined=isNullOrUndefined,exports.isNumber=isNumber,exports.isString=isString,exports.isSymbol=isSymbol,exports.isUndefined=isUndefined,exports.isRegExp=isRegExp,exports.isObject=isObject,exports.isDate=isDate,exports.isError=isError,exports.isFunction=isFunction,exports.isPrimitive=isPrimitive,exports.isBuffer=require("./support/isBuffer");var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];exports.log=function(){console.log("%s - %s",timestamp(),exports.format.apply(exports,arguments))},exports.inherits=require("inherits"),exports._extend=function(origin,add){if(!add||!isObject(add))return origin;for(var keys=Object.keys(add),i=keys.length;i--;)origin[keys[i]]=add[keys[i]];return origin}}).call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":68,_process:58,inherits:67}],70:[function(require,module,exports){"use strict";var ExtendDefault=(require("domquery"),require("./extend_default")),CanvasBoard=(require("./template-engine"),function(options){var defaults={selector:null};arguments[0]&&"object"==typeof arguments[0]&&(this.options=ExtendDefault(defaults,arguments[0]))});CanvasBoard.prototype.createBoard=function(text){console.log("Hi just created this "+text+" for you")},module.exports=new CanvasBoard},{"./extend_default":71,"./template-engine":74,domquery:34}],71:[function(require,module,exports){"use strict";module.exports=function(source,properties){for(var property in properties)properties.hasOwnProperty(property)&&(source[property]=properties[property]);return source}},{}],72:[function(require,module,exports){"use strict";var LocalStorage={getItem:function(key,optionalCallback){if(!this.supportsLocalStorage())return null;var callback=function(data){return data=void 0!==data?data:null,"function"==typeof optionalCallback?optionalCallback(data):data},value=localStorage.getItem(key);if(null!==value){if(value=JSON.parse(value),value.hasOwnProperty("__expiry")){var expiry=value.__expiry;return Date.now()>=expiry?(this.removeItem(key),callback()):callback(value.__data)}return callback(value)}return callback()},setItem:function(key,value,expiry){if(!this.supportsLocalStorage()||void 0===value||null===key||null===value)return!1;"number"==typeof expiry&&(value={__data:value,__expiry:Date.now()+1e3*parseInt(expiry)});try{return localStorage.setItem(key,JSON.stringify(value)),!0}catch(e){return console.log("Unable to store "+key+" in localStorage due to "+e.name),!1}},removeItem:function(key){this.supportsLocalStorage()&&localStorage.removeItem(key)},clear:function(){this.supportsLocalStorage()&&localStorage.clear()},supportsLocalStorage:function(){try{return localStorage.setItem("_","_"),localStorage.removeItem("_"),!0}catch(e){return!1}}};module.exports=LocalStorage},{}],73:[function(require,module,exports){"use strict";module.exports=function(element,html){if(null!==html){var child,frag=document.createDocumentFragment(),tmp=document.createElement("body");for(tmp.innerHTML=html;child=tmp.firstChild;)frag.appendChild(child);element.appendChild(frag),frag=tmp=null}}},{}],74:[function(require,module,exports){arguments[4][54][0].apply(exports,arguments)},{dup:54}]},{},[1])(1)});
