!function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{var g;g="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,g.Drawchim=f()}}(function(){return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";var ExtendDefault=require("./src/extend_default"),drawChim=function(options){if(!(this instanceof drawChim))return new drawChim;var defaults={selector:null,clearBtn:null};arguments[0]&&"object"==typeof arguments[0]&&(this.options=ExtendDefault(defaults,arguments[0])),this.canvas=this.options.selector,this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.isDown=!1,this.blankCanvas=!0,this.ctx=this.canvas.getContext("2d"),this.canvasX,this.canvasY,this._init()};drawChim.prototype._init=function(){this.createCanvas(),this.setEvents(),this.storeCanvasAsImage()},drawChim.prototype.createCanvas=function(){this.ctx.fillStyle="#000",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.lineWidth=6,this.ctx.lineCap="round",this.ctx.strokeStyle="rgba(0,0,255,0.5)"},drawChim.prototype.setEvents=function(){var _this=this;this.canvas.addEventListener("touchstart",function(e){e.preventDefault(),_this.drawStart(e)},!1),this.canvas.addEventListener("touchmove",function(e){_this.drawMove(e)},!1),this.canvas.addEventListener("touchend",function(e){_this.drawEnd()},!1),this.options.clearBtn.addEventListener("touchstart",function(){_this.clearCanvas()},!1)},drawChim.prototype.drawStart=function(e){var touchObj=e.changedTouches[0];this.blankCanvas&&this.storeHistory(),this.isDown=!0,this.ctx.beginPath(),this.canvasX=touchObj.pageX-this.canvas.offsetLeft,this.canvasY=touchObj.pageY-this.canvas.offsetTop,this.ctx.moveTo(this.canvasX,this.canvasY)},drawChim.prototype.drawMove=function(e){var touchObj=e.changedTouches[0];this.isDown!==!1&&(this.canvasX=touchObj.pageX-this.canvas.offsetLeft,this.canvasY=touchObj.pageY-this.canvas.offsetTop,this.ctx.lineTo(this.canvasX,this.canvasY),this.ctx.stroke())},drawChim.prototype.drawEnd=function(){this.isDown=!1,this.ctx.closePath(),this.storeHistory()},drawChim.prototype.storeHistory=function(){var img=this.canvas.toDataURL("image/png");history.pushState({imageData:img},"",window.location.href),window.localStorage&&(localStorage.curImg=img)},drawChim.prototype.storeCanvasAsImage=function(){var _this=this;if(window.localStorage){var img=new Image;img.onload=function(){_this.ctx.drawImage(img,0,0)},localStorage.curImg&&(img.src=localStorage.curImg,this.blankCanvas=!1)}},drawChim.prototype.clearCanvas=function(){this.ctx.fillStyle="#000",this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.storeHistory()},module.exports=drawChim},{"./src/extend_default":2}],2:[function(require,module,exports){"use strict";module.exports=function(source,properties){for(var property in properties)properties.hasOwnProperty(property)&&(source[property]=properties[property]);return source}},{}]},{},[1])(1)});
